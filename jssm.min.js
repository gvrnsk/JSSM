!function(t,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n():t.returnExports=n()}(this,function(){var t=function(t){"use strict";this._current="none",this._previous="none";var n={log:!0,strict:!1,history:!1};if(this.is().object(t)===!1)return this.log.error(0,t,!0),!1;if(this.is().object(t._settings)&&(n.log=this.is()["boolean"](t._settings.log)?t._settings.log:!0,n.strict=this.is()["boolean"](t._settings.strict)?t._settings.strict:!1),this.log.enabled=n.log,!this.is().array(t.transitions))return this.log.error(1,t.transitions,!0),!1;if(n.transitions=t.transitions,!this.is().object(t.actions))return this.log.error(2,t.actions,!0),!1;this.is().object(t.context)||(t.context={}),Object.defineProperty(this,"_settings",{value:this.getProtectedCopy(n),writable:!1});for(var i,e=0;e<t.transitions.length;e++)this.isCorrectTransition(t.transitions[e],t.actions)&&(i=this.createEvent(t.transitions[e],t.actions[t.transitions[e].name],t.context),this.is()["function"](i)&&Object.defineProperty(this,t.transitions[e].name,{value:i,writable:!1}))};return t.prototype={createEvent:function(t,n,i){var e;return this.is()["function"](n)||(n=function(){}),e=function(){var e,r;return this.can(t.name)?(e={name:t.name,from:this._current,to:t.to},r=Array.prototype.slice.call(arguments),r.unshift(e),n.apply(i,r),this._previous=this._current,this._current=t.to,this):this._settings.strict!==!0?this:void this.log.error(6,{name:t.name,from:this._current})}.bind(this),"none"!==t.from?e:void e()},can:function(t){for(var n=0;n<this._settings.transitions.length;n++)if(this._settings.transitions[n].name===t)return this._settings.transitions[n].from===this._current||this._settings.transitions[n].from.indexOf(this._current)>-1},cannot:function(t){return!this.can(t)},current:function(){return this._current},isCorrectTransition:function(t,n){"use strict";return this.is().object(t)?this.is().string(t.name)&&(this.is().string(t.from)||this.is().array(t.from))&&this.is().string(t.to)?this.isAllowedName(t.name)?(this.is()["function"](n[t.name])||this.log.warn(5,t.name,!0),!0):(this.log.error(7,t.name,!0),!1):(this.log.error(4,t,!0),!1):(this.log.error(3,t,!0),!1)},isAllowedName:function(t){return["createEvent","can","isAllowedName","isCorrectTransition","is","log","getProtectedCopy","_settings","_current","current","cannot"].indexOf(t)<0},getProtectedCopy:function(t){"use strict";var n={},i=function(t,n){var e;for(var r in n)this.is().primitive(n[r])?Object.defineProperty(t,r,{value:n[r],writable:!1}):(e=this.is(n[r]),Object.defineProperty(t,r,{value:function(){switch(e){case"object":return{};case"array":return[];case"function":return n[r]}}(),writable:!1}),"function"!==e&&i(t[r],n[r]))}.bind(this);return i(n,t),n},is:function(t){"use strict";var n=["[object Number]","[object String]","[object Undefined]","[object Null]","[object Boolean]"],i=function(t){return Object.prototype.toString.call(t)},e={array:function(t){return"[object Array]"===i(t)},object:function(t){return"[object Object]"===i(t)},number:function(t){return"[object Number]"===i(t)},string:function(t){return"[object String]"===i(t)},undefined:function(t){return"[object Undefined]"===i(t)},"null":function(t){return"[object Null]"===i(t)},"function":function(t){return"[object Function]"===i(t)},"boolean":function(t){return"[object Boolean]"===i(t)},primitive:function(t){return n.indexOf(i(t))>-1}};if(e.undefined(t))return e;for(var r in e)if(e[r](t))return r},log:{enabled:!0,codes:["Description must be an object not the:","Transitions must be described as array not the:","Actions must be contained in object not in the:","Transition must be described as an object not the:",'Incorrect transition: "name" must be a string, "from" must be a string or an array and "to" must be a string.',"No action specified for event named: ","Transition is not possible: ","Not allowed name for event: "],error:function(t,n,i){(this.enabled||i)&&console.error("Error.",this.codes[t],n)},warn:function(t,n,i){(this.enabled||i)&&console.warn("Warning.",this.codes[t],n)}}},t});